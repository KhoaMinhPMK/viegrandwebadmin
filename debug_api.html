<!DOCTYPE html>
<html>
<head>
    <title>Debug API Response</title>
</head>
<body>
    <h2>Debug VieGrand API Response</h2>
    <button onclick="testAPI()">Test API</button>
    <div id="result"></div>

    <script>
    async function testAPI() {
        const resultDiv = document.getElementById('result');
        
        try {
            resultDiv.innerHTML = '<p>Testing API...</p>';
            
            const url = 'https://viegrand.site/viegrandwebadmin/php/users.php?action=list&db=admin&page=1&limit=10';
            console.log('Testing URL:', url);
            
            const response = await fetch(url);
            const text = await response.text();
            
            console.log('Response status:', response.status);
            console.log('Response headers:', [...response.headers.entries()]);
            console.log('Response text:', text);
            
            let html = `
                <h3>Response Details:</h3>
                <p><strong>Status:</strong> ${response.status} ${response.statusText}</p>
                <p><strong>URL:</strong> ${url}</p>
                <h4>Response Text (first 1000 chars):</h4>
                <pre style="background: #f5f5f5; padding: 10px; border: 1px solid #ddd; max-height: 400px; overflow: auto;">${text.substring(0, 1000)}</pre>
            `;
            
            // Thử parse JSON
            try {
                const json = JSON.parse(text);
                html += `
                    <h4>✅ JSON Parse Successful:</h4>
                    <pre style="background: #e8f5e8; padding: 10px; border: 1px solid #4caf50;">${JSON.stringify(json, null, 2)}</pre>
                `;
            } catch (jsonError) {
                html += `
                    <h4>❌ JSON Parse Error:</h4>
                    <pre style="background: #ffe8e8; padding: 10px; border: 1px solid #f44336;">${jsonError.message}</pre>
                    <p><strong>First 50 characters of response:</strong></p>
                    <pre style="background: #fff3cd; padding: 10px; border: 1px solid #ffc107;">"${text.substring(0, 50)}"</pre>
                `;
            }
            
            resultDiv.innerHTML = html;
            
        } catch (error) {
            console.error('Fetch error:', error);
            resultDiv.innerHTML = `
                <h3>❌ Network Error:</h3>
                <pre style="background: #ffe8e8; padding: 10px; border: 1px solid #f44336;">${error.message}</pre>
            `;
        }
    }
    </script>
    
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</body>
</html>
